<figure class="figure" data-flat="{{ include.flat | default: false }}">
  {% assign width = include.width | default: "unset" %}
  {% assign height = include.height | default: "unset" %}
  <a 
    {% if include.link %}href="{{ include.link | relative_url }}"{% endif %}
    class="figure_image"
    style="width: {{ width }}; max-height: {{ height }};"
  >
    <img
      src="{{ include.image | relative_url }}"
      alt="{{ include.caption }}"
      title="{{ include.caption }}"
      style="width: 100%; height: {{ height }};"
      loading="lazy"
    />
  </a>
  {%- if include.caption -%}
  <figcaption class="figure_caption">
    {{- include.caption | markdownify | remove: "<p>" | remove: "</p>" -}}
  </figcaption>
  {%- endif -%}
</figure>
